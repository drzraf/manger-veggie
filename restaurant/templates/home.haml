-extends "bootstrap3/bootstrap3.html"

-load leaflet_tags

-block bootstrap3_extra_head
  -leaflet_js
  -leaflet_css

  :css
    .leaflet-container {
        width:  100%;
        height: 100vh;
    }

  :javascript
    function center_location (position) {
      resto_map.setView([position.coords.latitude, position.coords.longitude], 16);
    }

    function map_init (map, options) {
      resto_map = map

      $.getJSON("restaurants.json", function(data) {
        for (var i = 0; i < data.length; i ++) {
          var resto = data[i];
          L.marker([resto.lat, resto.lon]).addTo(map);
        }
      })

      navigator.geolocation.getCurrentPosition(center_location);
    }

-block bootstrap3_content
  .container
  -leaflet_map "map" callback="window.map_init"
